# UC-R2. Редактировать рецепт / создать копию.

*Автор*: Березовская Юлия
*Дата создания*: 26.11.2025

[Схема](https://github.com/juliaberezovskaya/kstoly/blob/use-cases/docs/use-cases/diagrams/%D0%A0%D0%B5%D1%86%D0%B5%D0%BF%D1%82.drawio.png)

---

## 1. Основное действующее лицо
Организатор

---

## 2. Дополнительные действующие лица
Отсутствуют

---

## 3. Описание
Организатор редактирует существующий рецепт, изменяя его данные и сохраняя обновлённую версию.
Также Организатор может создать новую копию рецепта на основе исходного, указав новое название. В этом случае создаётся новый рецепт, а исходный остаётся без изменений.

---

## 4. Условие-триггер
Организатор выбирает действие “Редактировать рецепт” в приложении.

---

## 5. Предварительные условия
PRE-1. Рецепт, выбранный для редактирования, существует в системе.
PRE-2. Пользователь является Организатором (user_id совпадает с owner_id мероприятия/рецепта).

---

## 6. Выходные условия
POST-1. В случае редактирования исходного рецепта его данные обновлены и сохранены в системе.
POST-2. В случае создания личной версии создан новый рецепт на основе исходного, а исходный рецепт остаётся без изменений.

---

## 7. Нормальное направление (основной поток)

1. Организатор выбирает действие “Редактировать рецепт”.
2. Система отображает форму редактирования рецепта с заполненными данными.
3. Организатор редактирует необходимые данные (в соответствии с бизнес-правилами).
4. Организатор инициирует сохранение новой версии рецепта.
5. Система обновляет рецепт.
6. Система подтверждает успешное обновление рецепта и отображает обновлённый рецепт.

---

## 8. Альтернативные направления
### A1. Отмена редактирования рецепта
1. Организатор выбирает действие «Отмена».
2. Система закрывает форму без изменения данных.

### A2. Создание копии рецепта  
1. Организатор выбирает действие «Сохранить как новый рецепт».
2. Система предлагает ввести новое название рецепта.
3. Организатор вводит новое название.
4. Система проверяет уникальность названия (см. E3).
5. Система создаёт новый рецепт на основе текущего и сохраняет его в библиотеку.
6. Система отображает новый рецепт.

---

## 9. Исключения

### E1. Ошибка валидации данных
1. Организатор вводит данные, нарушающие бизнес-правила (см. BR-R1).
2. Система применяет общие правила обработки ошибок (см. BR–S3).
3. Пользователь остаётся на текущем экране.


### E2. Ошибка сохранения
1. На шаге 6 основного потока или шаге 5 альтернативного потока A2 при сохранении рецепта система сталкивается с технической ошибкой (недоступен сервер/база данных, потеря соединения и т.п.).
2. Система применяет общие правила обработки ошибок (см. BR–S1-S2).
3. Пользователь остаётся на текущем экране.

### E3. Конфликт названия рецепта при создании личной копии (см. A2)
1. Организатор вводит название рецепта, которое уже существует среди его рецептов.
2. Система применяет общие правила обработки ошибок (см. BR–S3).
3. Пользователь остаётся на текущем экране.


---

## 10. Приоритет
**Высокий**

---

## 11. Бизнес-правила
- BR-R1 

---

## 12. Другая информация

- Связанные US: US-R2, US-R3
- Отмена редактирования не приводит к сохранению каких-либо изменений.

---

## 13. Предположения
P1. Предполагается, что Организатор редактирует рецепт корректной структуры (см. BR-R1).

