# UC-C2. Получить доступ к мероприятию по ссылке.

*Автор*: Березовская Юлия
*Дата создания*: 29.11.2025

[Схема](diagrams/Совместная%20работа.png)

---

## 1. Основное действующее лицо
Участник, получивший доступ по ссылке

---

## 2. Дополнительные действующие лица
-

---

## 3. Описание
Пользователь получает ссылку на мероприятие от организатора и открывает её.  
Система предоставляет ему доступ к мероприятию согласно правилам коллаборации: пользователь может просматривать меню, рецепты, список покупок и изменять статусы купленных продуктов.


---

## 4. Условие-триггер
Пользователь переходит по ссылке-приглашению, сформированной организатором.

---

## 5. Предварительные условия
**PRE-1.** Ссылка была корректно сгенерирована системой (см. UC-C1).  
**PRE-2.** Ссылка не истекла и не была отозвана (в MVP ссылки не истекают и отзыв не предусмотрен).  

---

## 6. Выходные условия
**POST-1.** Пользователь получает доступ к мероприятию в режиме «доступ по ссылке».  
**POST-2.** Пользователь может просматривать содержание мероприятия (BR-C3).  
**POST-3.** Пользователь может отмечать статусы пунктов списка продуктов (BR-C3).  

---

## 7. Нормальное направление (основной поток)
1. Пользователь открывает полученную ссылку в браузере.
2. Система проверяет валидность токена приглашения и определяет мероприятие, к которому этот токен привязан.
3. Система загружает данные мероприятия: название, дату, рецепты и список покупок.
4. Система предоставляет доступ в гостевом режиме по BR-C3.

5. Пользователь просматривает содержание мероприятия.
6. Пользователь изменяет статусы пунктов списка покупок («куплен» / «не куплен»).
7. Система сохраняет изменения и синхронизирует их со всеми участниками.

---

## 8. Альтернативные направления

### A1. Мероприятие недоступно
1. На шаге 3 основного потока система определяет, что доступ к мероприятию невозможен
   (например, мероприятие удалено, ссылка некорректна, токен не существует или истёк).
2. Система отображает сообщение: «Мероприятие недоступно».
3. Процесс завершается.

---

## 9. Исключения

### E1. Недействительная ссылка
1. На шаге 2 основного потока система определяет, что токен приглашения недействителен или повреждён.
2. Система отображает сообщение: «Ссылка недействительна или больше не доступна».
3. Процесс завершается.

### E2. Техническая ошибка при загрузке мероприятия
1. На шаге 3 происходит ошибка сервера.
2. Система применяет общие правила обработки ошибок BR-S2.
3. Пользователь остаётся на текущем экране.

### E3. Ошибка синхронизации статуса продукта
1. На шаге 7 основного потока система не может сохранить изменения статуса (проблемы с сетью или сервером).
2. Система уведомляет пользователя, что изменение не было сохранено.
3. Система предлагает повторить действие.

---

## 10. Приоритет
**Высокий**

---

## 11. Бизнес-правила
- [BR-C1](../business-rules.md#br-c1-доступ-к-мероприятию-по-ссылке)
- [BR-C2](../business-rules.md#br-c2-права-организатора)
- [BR-C3](../business-rules.md#br-c3-права-участника-по-ссылке)
- [BR-S2](../business-rules.md#br-s-общие-правила-обработки-ошибок)

---

## 12. Другая информация

- Связанные US: [US-C2](../user-stories.md#us-c2-как-участник-мероприятия-я-хочу-получить-доступ-к-мероприятию-по-ссылке-чтобы-ознакоимиться-с-рецептом-и-работать-со-списком-покупок).

---

## 13. Предположения

- P1. В MVP доступ по ссылке предоставляется без авторизации пользователя.  
- P2. В MVP отсутствует механизм отзыва или истечения срока ссылки.  
- P3. Пользователь может открыть ссылку на любом устройстве с веб-браузером.  
- P4. [Роль участника по ссылке](/Глоссарий.md#пользователь-получивший-доступ-к-мероприятию-в-рамках-mvp-может-просматривать-рецепты-список-покупок-и-помечать-купленные-продукты-участник-не-имеет-аккаунт-в-рамках-mvp-участники-получают-доступ-к-мероприятию-по-ссылке-приглашению-и-являются-анонимными) — это отдельный тип доступа, не совпадающий с ролью «Организатор».  
- P5. Все изменения статусов продуктов сохраняются и видны организатору и другим участникам.  
- P6. Система может использовать локальное хранилище браузера для кеширования токена.  
- P7. Если мероприятие было удалено Организатором после генерации ссылки, доступ по ссылке невозможен (см. E1/E2).
