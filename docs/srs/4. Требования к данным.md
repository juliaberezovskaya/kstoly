# 4. Требования к данным

## 4.1 Логическая модель данных

### 4.1.1 Назначение модели данных

Логическая модель данных описывает состав данных, используемых приложением **_К столу!_**, а также связи и ключевые ограничения между этими данными в рамках **_Release 0.1 (MVP)_**. Модель предназначена для согласования общего понимания данных между участниками разработки и служит основой для проектирования базы данных, разработки API и подготовки тестовых сценариев. Логическая модель фиксирует *что* должно храниться и обрабатываться системой, но не определяет физическую реализацию хранения (конкретные типы СУБД, индексы, оптимизации и т.п.).

### 4.1.2 Перечень сущностей

В рамках **_Release 0.1 (MVP)_** используются следующие основные сущности:

- **_Организатор_** — владелец данных (рецептов и мероприятий), создаёт мероприятия и управляет ими.
- **_Рецепт_** — описание блюда, сохранённое в библиотеке рецептов **_Организатора_**.
- **_Ингредиент рецепта_** — элемент состава **_Рецепта_** (наименование, количество, единица измерения и уточнение).
- **_Мероприятие_** — объект планирования готовки, содержащий метаданные и список выбранных рецептов.
- **_Рецепт в мероприятии_** — связь **_Мероприятия_** и **_Рецепта_** с указанием количества порций для данного мероприятия.
- **_Пункт списка покупок_** — строка в **_Списке покупок_** мероприятия (наименование, количество, единица измерения, признак «куплено/не куплено», список примечаний и источник формирования).
- **_Справочник ингредиентов_** — внутренний справочник, используемый для выбора/подсказки ингредиентов при вводе рецепта и для повышения качества агрегации списка покупок.
- **_Единицы измерения_** — перечень единиц измерения продуктов, содержит сокращения для обозначения.

### 4.1.3 Связи и кратности

Основные связи сущностей:

- **_Организатор_** 1 — * **_Рецепт_**  
  Один **_Организатор_** может иметь множество **_Рецептов_**. Каждый **_Рецепт_** принадлежит одному **_Организатору_**.

- **_Рецепт_** 1 — * **_Ингредиент рецепта_**  
  Один **_Рецепт_** содержит один или более **_Ингредиентов рецепта_**. Каждый **_Ингредиент рецепта_** относится к одному **_Рецепту_**.

- **_Организатор_** 1 — * **_Мероприятие_**  
  Один **_Организатор_** может создать множество **_Мероприятий_**. Каждое **_Мероприятие_** принадлежит одному **_Организатору_**.

- **_Мероприятие_** 1 — * **_Рецепт в мероприятии_**  
  Одно **_Мероприятие_** содержит множество записей **_Рецепт в мероприятии_** (по одной на каждый добавленный рецепт). Каждая запись относится к одному **_Мероприятию_**.

- **_Рецепт_** 1 — * **_Рецепт в мероприятии_**  
  Один **_Рецепт_** может быть использован во многих **_Мероприятиях_**. Каждая запись **_Рецепт в мероприятии_** ссылается на один **_Рецепт_**.

- **_Мероприятие_** 1 — * **_Пункт списка покупок_**  
  У одного **_Мероприятия_** есть один **_Список покупок_**, представленный множеством **_Пунктов списка покупок_**. Каждый **_Пункт списка покупок_** относится к одному **_Мероприятию_**.

- **_Справочник ингредиентов_** 0..1 — 0..* **_Ингредиент рецепта_**  
  **_Ингредиент рецепта_** может иметь ссылку на элемент **_Справочника ингредиентов_** (если выбран из справочника). Один элемент справочника может использоваться в множестве ингредиентов разных рецептов.

  - **_Ингредиент рецепта_** * — 1 **_Единица измерения_**  
  Один **Ингредиент рецепта** содержит одну **_Единицу измерения_**. Каждая **_Единица измерения_** может относится ко многим ингредиентам рецепта **_Рецепту_**.

### 4.1.4 Диаграмма модели данных

Диаграмма концептуальной модели данных представлена на рисунке [4.1](Приложение%20Б.%20Диаграммы/4.1%20-%20Диаграмма%20концептуальной%20модели%20данных.jpg)
ER-диаграмма логической модели данных представлена на рисунке [4.2](Приложение%20Б.%20Диаграммы/4.2%20-%20Диаграмма%20логической%20модели%20данных.jpg).

### 4.1.5 Ключевые ограничения данных

- Название **_Рецепта_** должно быть уникальным в библиотеке рецептов **_Организатора_**.
- **_Рецепт_** должен содержать название и как минимум один **_Ингредиент рецепта_**.
- Среди активных (не архивированных) **_Мероприятий_** **_Организатора_** не допускается наличие двух **_Мероприятий_** с одинаковым сочетанием «название + дата проведения (без времени)».
- В одном **_Мероприятии_** один и тот же **_Рецепт_** не может присутствовать более одного раза (без дублирования); изменение количества порций выполняется через атрибут порций записи **_Рецепт в мероприятии_**.
- Архивированное **_Мероприятие_** не подлежит изменению (метаданные и состав неизменяемы).
- **_Пункт списка покупок_** содержит признак «куплено/не куплено», который изменяется **_Организатором_** и **_Участником по ссылке_** и сохраняется системой.
- В рамках MVP преобразование единиц измерения при агрегации **_Списка покупок_** не выполняется; ингредиенты с разными единицами измерения отображаются отдельными пунктами.

### 4.1.6 Идентификаторы и область видимости данных

- Все данные (рецепты, мероприятия, список покупок) принадлежат конкретному **_Организатору_** и изолированы от других организаторов.
- **_Участник по ссылке_** не является владельцем данных и получает доступ только к данным конкретного **_Мероприятия_**, на которое указывает **_Ссылка-приглашение_**.
- Система использует внутренние идентификаторы сущностей (например: `organizer_id`, `recipe_id`, `event_id`, `shopping_item_id`) для ссылок между сущностями и обеспечения целостности данных.


## 4.2 Словарь данных

### 4.2.1 Правила оформления словаря данных

Словарь данных описывает атрибуты (поля) сущностей, используемых в **_Release 0.1 (MVP)_**, и их основные ограничения. Словарь предназначен для согласования трактовки данных между участниками разработки, а также для обеспечения тестируемости требований.

Для каждого поля указываются:

- **Имя поля** — в формате `snake_case`.
- **Описание** — смысл поля в предметной области.
- **Тип (логический)** — `string/int/decimal/bool/date/time/datetime/enum/uuid/token`.
- **Обязательность** — `обязательно` или `опционально`.
- **Ограничения** — уникальность, допустимые значения/диапазоны, формат, длина, значение по умолчанию.
- **Пример** — пример корректного значения.
- **Связи** — ссылка на связанную сущность (если применимо).

Примечания:
- В словаре фиксируются логические ограничения данных. Физическая реализация хранения (типы СУБД, индексы, оптимизации) в рамках данного документа не задаётся.
- Если поле или правило уточняется позднее, оно помечается как `TBD` и уточняется при актуализации документа.

### 4.2.2. Сущность: Организатор

**[Организатор - Organizers](Приложение%20А.%20Глоссарий.md#организатор)**

| Имя | Описание | Тип | Обязательность | Ограничения | Пример | Связи |
|-----|----------|-----|----------------|-------------|--------|-------|
| organizer_id | Уникальный идентификатор Организатора | UUID | Обязателен | Уникален | 550e8400-e29b-41d4-a716-446655440000 | PK |
| created_at | Дата создания организатора | DateTime | Опционален | - | '2023-10-27 14:30:00' | - |


### 4.2.3. Сущность: Рецепт

**[Рецепт - Recipes](Приложение%20А.%20Глоссарий.md#рецепт)**

| Имя | Описание | Тип | Обязательность | Ограничения | Пример | Связи |
|-----|----------|-----|----------------|-------------|--------|-------|
| recipe_id | Уникальный идентификатор рецепта | UUID | Обязателен | Уникален | 550e8400-e29b-41d4-a716-446655440000 | PK |
| organizer_id | Организатор, которому принадлежит рецепт | UUID | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | FK - Organizers.organizer_id |
| name | Название рецепта | String | Обязателен | Уникально для организатора <br> Ограничение символов 1-120 TBD | "Салат с авокадо и креветками" | - |
| total_time | [Общее время приготовления](Приложение%20А.%20Глоссарий.md#общее-время-приготовления) | Duration | Опционален | - | 01:30 | - |
| active_time | [Активное время приготовления](Приложение%20А.%20Глоссарий.md#активное-время-приготовления) | Duration | Опционален | - | 01:30 | - |
| recipe_text | Описание приготовления | Text | Опционален | - | 1. Подготовить ингредиенты <br> 2. Нарезать ингредиенты <br> 3. Перемешать | - |
| category_id | Категория рецепта | enum | Опционален | Значение из списка категорий; по умолчанию `Другое` TBD | "Салат" | - |
| servings_default  | Количество порций рецепта по умолчанию | int | Обязателен | >= 1, По умолчанию 1. | 4 | - |
| cover_url | Обложка | String | Опционален | Ограничения по файлу TBD | "https://img.delo-vcusa.ru/2017/06/Tort-s-klubnikoy-768x492.jpg" | - |


### 4.2.4. Сущность: Ингредиент рецепта

**[Ингредиент - Ingredients](Приложение%20А.%20Глоссарий.md#ингредиент)**

| Имя | Описание | Тип | Обязательность | Ограничения | Пример | Связи |
|-----|----------|-----|----------------|-------------|--------|-------|
| ingredient_id | Уникальный идентификатор ингредиента рецепта | UUID | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | PK |
| recipe_id | Рецепт, к которому относится ингредиент | UUID | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | FK - Recipes.recipe_id |
| quantity | Количество | Decimal | Обязателен | - | 1.0 | - |
| unit_id | Единица измерения | UUID | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | FK - Units.unit_id |
| ingredient_catalog_id | Ингредиент из базы данных ингредиентов | UUID | Опционален | Ограничения | 550e8400-e29b-41d4-a716-446655440000 | FK - IngredientsCatalog.ingredient_catalog_id |
| name | Название ингредиента | String | Обязателен| 1-120 символов | "Томат" | - |
| comment | Комментарий об ингредиенте рецепта | String | Опционален | Органичение символов TBD | "Сухарики лучше купить из ярче" | - |


### 4.2.5. Сущность: Мероприятие

**[Мероприятие - Events](Приложение%20А.%20Глоссарий.md#мероприятие)**

| Имя | Описание | Тип | Обязательность | Ограничения | Пример | Связи |
|-----|----------|-----|----------------|-------------|--------|-------|
| event_id | Уникальный идентификатор мероприятия | UUID | Обязателен | Ограничения | 550e8400-e29b-41d4-a716-446655440000 | PK |
| name | Название мероприятия | String | Обязателен | 1-120 символов | "День рождения мамы" | - |
| date | Дата мероприятия | Date | Обязателен | Существующая дата | "08.10.2026" | - |
| time | Время мероприятия | Time | Опционален | - | 18:00 | - |
| organaizer_id | Организатор мероприятия | UUID | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | FK - Organizers.organizer_id |
| invite_token | Токен мероприятия | String | Обязателен | Уникален у каждого мероприятия | "den_rojdenia_mamy081020261800" | - |
| is_archived | Архивировано ли мероприятие | Bool | Обязателен | - | false | - |


### 4.2.6. Сущность: Рецепт в мероприятии

**Рецепт в мероприятии (EventRecipes)** — связующая сущность между **_Мероприятием_** и **_Рецептом_**, содержащая параметры приготовления **_Рецепта_** в рамках конкретного **_Мероприятия_** (количество порций).

| Имя | Описание | Тип | Обязательность | Ограничения | Пример | Связи |
|-----|----------|-----|----------------|-------------|--------|-------|
| event_id | Идентификатор **_Мероприятия_** | uuid | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | FK → Events.event_id |
| recipe_id | Идентификатор **_Рецепта_** | uuid | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | FK → Recipes.recipe_id |
| amount | Количество порций **_Рецепта_** для данного **_Мероприятия_** | decimal | Обязателен | `> 0` | 6 | - |

Ограничения:
- Уникальность комбинации `event_id + recipe_id` (запрещает дублирование одного и того же **_Рецепта_** в одном **_Мероприятии_**).
- Изменение количества порций выполняется через изменение значения `amount` у существующей записи.


### 4.2.7. Сущность: Пункт списка покупок

**Пункт списка покупок (Purchases)** — агрегированная позиция **_Списка покупок_** **_Мероприятия_** с количеством и единицей измерения, доступная для отметки «куплено/не куплено».

| Имя | Описание | Тип | Обязательность | Ограничения | Пример | Связи |
|-----|----------|-----|----------------|-------------|--------|-------|
| purchase_id | Уникальный идентификатор **_Пункта списка покупок_** | uuid | Обязателен | Уникален | 550e8400-e29b-41d4-a716-446655440000 | PK |
| event_id | Идентификатор **_Мероприятия_**, к которому относится пункт | uuid | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | FK → Events.event_id |
| name | Наименование пункта (отображаемое) | string | Обязателен | 1–120 символов (TBD) | Томат | - |
| quantity | Количество | decimal | Обязателен | `> 0` (TBD) | 3.0 | - |
| unit_id | Единица измерения количества | uuid | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | FK → Units.unit_id |
| is_checked | Признак «куплено/не куплено» | bool | Обязателен | По умолчанию `false` | false | - |

Примечание:
- Для хранения источников и примечаний к пункту используются записи **PurchaseSources** (см. 4.2.7.1).


#### 4.2.7.1. Сущность: Источник пункта списка покупок

**Источник пункта списка покупок (PurchaseSources)** — связывает **_Пункт списка покупок_** с конкретными **_Ингредиентами рецептов_**, из которых сформирован данный пункт. Используется для трассировки и вывода примечаний к ингредиентам в **_Списке покупок_**.

| Имя | Описание | Тип | Обязательность | Ограничения | Пример | Связи |
|-----|----------|-----|----------------|-------------|--------|-------|
| purchase_id | Идентификатор **_Пункта списка покупок_** | uuid | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | FK → Purchases.purchase_id |
| ingredient_id | Идентификатор **_Ингредиента рецепта_**, являющегося источником | uuid | Обязателен | - | 550e8400-e29b-41d4-a716-446655440000 | FK → Ingredients.ingredient_id |

Ограничения:
- Уникальность комбинации `purchase_id + ingredient_id` (один ингредиент не должен дважды указываться как источник одного и того же пункта).


### 4.2.8. Сущность: Справочник ингредиентов

**Справочник ингредиентов (Ingredients_Catalog)** — внутренний справочник, используемый для выбора/подсказки ингредиентов при вводе **_Рецепта_** и для повышения качества агрегации **_Списка покупок_**.

| Имя | Описание | Тип | Обязательность | Ограничения | Пример | Связи |
|-----|----------|-----|----------------|-------------|--------|-------|
| ingredient_catalog_id | Уникальный идентификатор элемента справочника | uuid | Обязателен | Уникален | 550e8400-e29b-41d4-a716-446655440000 | PK |
| name | Отображаемое имя ингредиента | string | Обязателен | 1–120 символов (TBD); уникальность в справочнике (TBD) | Томат | - |
| default_unit | Единица измерения по умолчанию (для подсказки/агрегации) | uuid | Опционален | - | 550e8400-e29b-41d4-a716-446655440000 | FK → Units.unit_id |

Примечание:
- В MVP список **Ingredients_Catalog** может быть неполным; при отсутствии совпадения ингредиент вводится вручную в **Ingredients** (см. 4.2.4).


### 4.2.9. Сущность: Единица измерения

**Единица измерения (Units)** — справочник допустимых единиц измерения, используемых в **Ingredients** и **Purchases**.

| Имя | Описание | Тип | Обязательность | Ограничения | Пример | Связи |
|-----|----------|-----|----------------|-------------|--------|-------|
| unit_id | Уникальный идентификатор единицы измерения | uuid | Обязателен | Уникален | 550e8400-e29b-41d4-a716-446655440000 | PK |
| name | Отображаемое название единицы измерения | string | Обязателен | 1–64 символа (TBD) | грамм | - |
| symbol | Краткое обозначение единицы измерения | string | Обязателен | 1–16 символов (TBD) | г | - |


## 4.3. Отчёты

### 4.3.1. Перечень отчётов MVP

В MVP отчёты не предусмотрены.

## 4.4. Получение, ценность, хранение и утилизация данных

### 4.4.1. Источники данных

В рамках **_Release 0.1 (MVP)_** система использует следующие источники данных:

- **Пользовательский ввод (основной источник)**
  - **_Рецепты_**: метаданные рецепта и текст приготовления вводятся **_Организатором_** вручную.
  - **_Ингредиенты рецепта_**: наименование, количество, единица измерения и примечание вводятся **_Организатором_**. При наличии совпадения **_Организатор_** может выбрать ингредиент из **_Справочника ингредиентов_**.
  - **_Мероприятия_**: название, дата и время мероприятия вводятся **_Организатором_** вручную.
  - **_Рецепты в мероприятии_**: выбор рецептов из библиотеки и указание количества порций вводятся **_Организатором_**.

- **Автоматическая генерация системой**
  - **_Ссылка-приглашение_**: генерируется системой при создании **_Мероприятия_**.
  - **_Список покупок_**: формируется системой автоматически на основании состава **_Мероприятия_** (ингредиентов выбранных рецептов с учётом количества порций) и правил агрегации.
  - **Источники пунктов списка покупок**: связи **_Пунктов списка покупок_** с **_Ингредиентами рецепта_** формируются системой автоматически при построении **_Списка покупок_**.

- **Смешанный источник (пользователь + система)**
  - **_Пункты списка покупок_**:
    - автоматически создаются системой при генерации списка покупок;
    - могут дополняться/изменяться **_Организатором_** вручную (если это предусмотрено функциональными требованиями списка покупок).
  - **Признак «куплено/не куплено»** у **_Пунктов списка покупок_** изменяется пользователями (**_Организатором_** и **_Участником по ссылке_**) и сохраняется системой.

- **Внутренний справочник**
  - **_Справочник ингредиентов_**:
    - начальное наполнение выполняется вручную (внутренний источник данных проекта);
    - в рамках MVP справочник может дополняться на основании пользовательского ввода (например, через добавление новых элементов администратором/разработчиком по результатам анализа наиболее частых ручных ингредиентов).

### 4.4.2. Правила хранения и обновления

#### Хранение данных
- Данные приложения хранятся в серверной базе данных и доступны пользователям через веб-приложение.
- Система сохраняет следующие данные:
  - **_Рецепты_** и связанные **_Ингредиенты рецепта_**;
  - **_Мероприятия_** и состав **_Рецептов в мероприятии_** (включая количество порций);
  - **_Список покупок_** **_Мероприятия_** (включая признак «куплено/не куплено» для каждого **_Пункта списка покупок_**);
  - **_Ссылка-приглашение_** в составе **_Мероприятия_** (поле `invite_token`).

#### Обновление данных и правила пересчёта
- При изменении состава **_Мероприятия_** (добавление/удаление **_Рецепта_** или изменение количества порций) система должна актуализировать **_Список покупок_** данного **_Мероприятия_** в соответствии с текущим составом.
- Если **_Рецепт_** изменён в библиотеке **_Организатора_**, система должна учитывать актуальную версию **_Рецепта_** при следующей актуализации **_Списка покупок_** для мероприятий, где этот **_Рецепт_** используется.

#### Правила фиксации изменений (сохранение)
- Изменения **_Рецепта_** сохраняются по явному действию пользователя (например, «Сохранить»).
- Изменения состава **_Мероприятия_** (добавление/удаление рецептов, изменение порций) сохраняются автоматически системой.
- Изменения признака «куплено/не куплено» для **_Пунктов списка покупок_** сохраняются системой автоматически при изменении пользователем (**_Организатором_** или **_Участником по ссылке_**).

#### Синхронизация между пользователями
- При наличии сетевого соединения система должна обеспечивать отображение актуального состояния **_Списка покупок_** для всех пользователей, имеющих доступ к одному **_Мероприятию_**.
- Требование к точной периодичности синхронизации (например, раз в N секунд) в рамках MVP не фиксируется и определяется реализацией, при условии выполнения функциональных требований по согласованности отметок «куплено/не куплено».

### 4.4.3. Удаление и восстановление

#### Общие правила
- В рамках **_Release 0.1 (MVP)_** удаление **_Рецептов_** и **_Мероприятий_** является безвозвратным: корзина и восстановление удалённых данных не предусмотрены.

#### Удаление мероприятия и поведение ссылки-приглашения
- При удалении **_Мероприятия_** система должна сделать доступ по **_Ссылке-приглашению_** недействительным.
- При переходе по **_Ссылке-приглашению_**, относящейся к удалённому **_Мероприятию_**, система должна отображать информационную страницу о том, что мероприятие не существует или было удалено.

#### Удаление рецепта и влияние на мероприятия
- Удаление **_Рецепта_** должно быть отклонено, если **_Рецепт_** используется хотя бы в одном **_Мероприятии_** (включая архивированные).
- В связи с данным ограничением в рамках MVP ситуация, когда архивированное **_Мероприятие_** содержит удалённый **_Рецепт_**, не допускается.

### 4.4.4. Архивирование и жизненный цикл данных

#### Понятие архива и состояние мероприятия
- **_Мероприятие_** в системе может находиться в одном из состояний: **активное** или **архивированное**.
- Архивирование означает перевод **_Мероприятия_** в состояние, при котором оно исключается из основной библиотеки мероприятий и отображается в архиве.

#### Какие данные “замораживаются” при архивировании
- При переводе **_Мероприятия_** в архив система должна сохранять и фиксировать:
  - метаданные **_Мероприятия_** (название, дата, время);
  - состав **_Мероприятия_** (список **_Рецептов в мероприятии_** и количество порций для каждого рецепта);
  - связанный **_Список покупок_** и состояние признака «куплено/не куплено» для **_Пунктов списка покупок_**.
- В архивированном состоянии изменение метаданных и состава **_Мероприятия_** не допускается.

#### Доступность данных для просмотра
- Архивированное **_Мероприятие_** доступно для просмотра **_Организатору_**.
- Из архивированного **_Мероприятия_** пользователь может:
  - просматривать метаданные;
  - просматривать состав (перечень **_Рецептов_** и количество порций);
  - просматривать связанный **_Список покупок_** и состояние отметок «куплено/не куплено»;
  - открывать **_Рецепты_** по сохранённым ссылкам на рецепты (при условии, что рецепт существует и не удалён).

#### Повтор мероприятия
- Система должна предоставлять **_Организатору_** возможность создать новое **_Мероприятие_** на основе архивированного (**повтор мероприятия**).
- При повторе мероприятия система должна:
  - создать новое **_Мероприятие_** (в активном состоянии);
  - перенести в него состав из архивированного мероприятия: ссылки на **_Рецепты_** и количество порций;
  - сформировать **_Список покупок_** для нового мероприятия в соответствии с текущими версиями рецептов и правилами агрегации.
- Метаданные нового **_Мероприятия_** вводятся и валидируются по тем же правилам, что и при обычном создании мероприятия.

#### Разархивирование
- Система должна предоставлять **_Организатору_** возможность разархивировать **_Мероприятие_**.
- При разархивировании **_Мероприятие_** переводится в активное состояние, возвращается в основную библиотеку мероприятий, и для него становится доступно редактирование в соответствии с правилами активных мероприятий.

### 4.4.5. Качество данных и риски

В рамках **_Release 0.1 (MVP)_** качество данных зависит преимущественно от пользовательского ввода и ограничений MVP. Ниже перечислены ключевые риски и ожидаемое поведение системы.

#### Неполнота справочника ингредиентов
**Риск:** **_Справочник ингредиентов_** может не содержать нужного пользователю ингредиента, что снижает качество агрегации и унификации данных.  
**Поведение системы:**
- Система должна позволять вводить ингредиент вручную, даже если он отсутствует в справочнике.
- При ручном вводе ингредиента система сохраняет введённое наименование как текст, без гарантии сопоставления со справочником.

#### Разные единицы измерения без конвертации
**Риск:** один и тот же ингредиент может быть указан в разных единицах измерения (например, «2 шт» и «100 г»), что мешает точной агрегации.  
**Поведение системы:**
- В MVP система не выполняет конвертацию единиц измерения при построении **_Списка покупок_**.
- Позиции с одинаковым наименованием, но разными единицами измерения, отображаются отдельными пунктами списка покупок.

#### Опечатки и дубли при ручном вводе
**Риск:** при ручном вводе возможны опечатки, разные варианты написания и дубли («помидор», «томаты», «томат»), что приводит к разбиению одной позиции на несколько.  
**Поведение системы:**
- В MVP система не гарантирует автоматическое объединение позиций с различающимися наименованиями.
- Агрегация выполняется только для совпадающих по наименованию и единице измерения (в рамках выбранных правил агрегации).

#### Потеря связности источников данных для списка покупок
**Риск:** при изменениях состава **_Мероприятия_** может нарушиться корректность связей между пунктами списка покупок и их источниками (ингредиентами рецептов).  
**Поведение системы:**
- При актуализации **_Списка покупок_** система должна пересчитывать пункты и поддерживать корректные связи источников (трассировку формирования) в пределах возможностей MVP.

#### Общий риск качества данных
**Риск:** данные могут быть неполными или неоднозначными из-за человеческого фактора и упрощений MVP.  
**Поведение системы:**
- Система хранит данные в том виде, в котором они введены пользователем, и не выполняет “интеллектуальную нормализацию” (синонимы, исправление опечаток, преобразование единиц) в MVP.

