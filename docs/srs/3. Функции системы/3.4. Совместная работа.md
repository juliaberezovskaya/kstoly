## 3.4 Совместная работа

### 3.4.1 Описание

Функция **_Совместная работа_** обеспечивает участие нескольких пользователей в подготовке к одному **_Мероприятию_** на основании **_Ссылки-приглашения_**, созданной для **_Мероприятия_**. **_Организатор_** предоставляет доступ к **_Мероприятию_** внешним участникам без полноценной авторизации, передавая **_Ссылку-приглашение_** вне приложения.

**_Участник по ссылке_** получает доступ к просмотру **_Мероприятия_**, **_Рецептов_** мероприятия и **_Списка покупок_**, а также может отмечать **_Пункты списка покупок_** как купленные. Система должна обеспечивать согласованность отметок «куплено/не куплено» для всех пользователей, работающих с одним **_Мероприятием_**.

**Связанные артефакты:**  
Use Cases: `UC-E4`, `UC-L1`, `UC-L3`  
User Stories: `US-E8`, `US-S1`, `US-S2`


### 3.4.2 Функциональные требования

### FR-C0. Управление ссылкой-приглашением

#### FR-C0.1.
Система должна создавать **_Ссылку-приглашение_** для **_Мероприятия_** при создании **_Мероприятия_**.  
Приоритет: Высокий  
Источники: [UC-C1](../../use-cases/UC-C1.%20Поделиться%20доступом%20к%20мероприятию.md)

#### FR-C0.2.
Система должна отображать **_Организатору_** **_Ссылку-приглашение_** на экране просмотра/редактирования **_Мероприятия_**.  
Приоритет: Высокий  
Источники: [UC-C1](../../use-cases/UC-C1.%20Поделиться%20доступом%20к%20мероприятию.md)

#### FR-C0.3.
Система должна предоставлять **_Организатору_** возможность скопировать **_Ссылку-приглашение_** для передачи вне приложения.  
Приоритет: Высокий  
Источники: [UC-C1](../../use-cases/UC-C1.%20Поделиться%20доступом%20к%20мероприятию.md), [US-C1](../../user-stories.md#us-c1-как-организатор-я-хочу-поделиться-доступом-к-мероприятию-чтобы-помощники-знали-что-покупать-и-что-готовить)

#### FR-C0.4.
Если **_Ссылка-приглашение_** не может быть создана или отображена, система должна отображать **_Организатору_** сообщение об ошибке.  
Приоритет: Средний  
Источники: [UC-C1](../../use-cases/UC-C1.%20Поделиться%20доступом%20к%20мероприятию.md)


### FR-C1. Доступ по ссылке и сессия участника

#### FR-C1.1.
Система должна предоставлять **_Участнику по ссылке_** доступ к **_Мероприятию_** по **_Ссылке-приглашению_**.  
Приоритет: Высокий  
Источники: [UC-C2](../../use-cases/UC-C2.%20Получить%20доступ%20к%20мероприятию%20по%20ссылке.md), [US-C2](../../user-stories.md#us-c2-как-участник-мероприятия-я-хочу-получить-доступ-к-мероприятию-по-ссылке-чтобы-ознакоимиться-с-рецептом-и-работать-со-списком-покупок)

#### FR-C1.2.
Система должна предоставлять **_Участнику по ссылке_** доступ к просмотру метаданных **_Мероприятия_** и списка **_Рецептов_** **_Мероприятия_**.  
Приоритет: Высокий  
Источники: [UC-C2](../../use-cases/UC-C2.%20Получить%20доступ%20к%20мероприятию%20по%20ссылке.md)

#### FR-C1.3.
Система должна предоставлять **_Участнику по ссылке_** доступ к просмотру связанного **_Списка покупок_** **_Мероприятия_**.  
Приоритет: Высокий  
Источники: [UC-C2](../../use-cases/UC-C2.%20Получить%20доступ%20к%20мероприятию%20по%20ссылке.md)

#### FR-C1.4.
Система должна обеспечивать возможность одновременного доступа к одному **_Мероприятию_** по одной **_Ссылке-приглашению_** для нескольких **_Участников по ссылке_**.  
Приоритет: Средний  
Источники: [UC-C2](../../use-cases/UC-C2.%20Получить%20доступ%20к%20мероприятию%20по%20ссылке.md)

#### FR-C1.5.
Система должна отображать сообщение об ошибке, если доступ к **_Мероприятию_** по **_Ссылке-приглашению_** невозможен (например, ссылка некорректна или **_Мероприятие_** удалено).  
Приоритет: Высокий  
Источники: [UC-C2](../../use-cases/UC-C2.%20Получить%20доступ%20к%20мероприятию%20по%20ссылке.md)


### FR-C2. Ограничения прав участника по ссылке

#### FR-C2.1.
Система не должна предоставлять **_Участнику по ссылке_** возможность редактировать метаданные **_Мероприятия_**.  
Приоритет: Высокий  
Источники: [BR-C3](../../business-rules.md#br-c3-права-участника-по-ссылке)

#### FR-C2.2.
Система не должна предоставлять **_Участнику по ссылке_** возможность изменять состав **_Мероприятия_** (добавлять/удалять **_Рецепты_**, изменять количество порций).  
Приоритет: Высокий  
Источники: [BR-C3](../../business-rules.md#br-c3-права-участника-по-ссылке)

#### FR-C2.3.
Система не должна предоставлять **_Участнику по ссылке_** возможность вручную изменять **_Список покупок_** (добавлять/редактировать/удалять **_Пункты списка покупок_**, пересоздавать список).  
Приоритет: Высокий  
Источники: [BR-C3](../../business-rules.md#br-c3-права-участника-по-ссылке)

> Примечание: **_Участник по ссылке_** может изменять только признак «куплено/не куплено» (см. FR-C3).


### FR-C3. Синхронизация отметок «куплено/не куплено»

#### FR-C3.1.
Система должна предоставлять **_Организатору_** и **_Участнику по ссылке_** возможность отмечать **_Пункты списка покупок_** как «куплено/не куплено».  
Приоритет: Высокий  
Источники: [UC-C2](../../use-cases/UC-C2.%20Получить%20доступ%20к%20мероприятию%20по%20ссылке.md)

#### FR-C3.2.
Система должна сохранять изменения признака «куплено/не куплено» для **_Пунктов списка покупок_** и применять их для всех пользователей, имеющих доступ к тому же **_Мероприятию_**.  
Приоритет: Высокий  
Источники: [UC-C2](../../use-cases/UC-C2.%20Получить%20доступ%20к%20мероприятию%20по%20ссылке.md)

#### FR-C3.3.
Система должна обеспечивать отображение актуального состояния признака «куплено/не куплено» для **_Пунктов списка покупок_** всем пользователям, работающим с одним **_Мероприятием_**.  
Приоритет: Высокий  
Источники: 

#### FR-C3.4.
В случае одновременного изменения одного и того же **_Пункта списка покупок_** несколькими пользователями система должна применять последнее сохранённое изменение как актуальное значение признака «куплено/не куплено».  
Приоритет: Средний  
Источники: 

#### FR-C3.5.
Если изменение признака «куплено/не куплено» не может быть сохранено, система должна отображать пользователю сообщение об ошибке.  
Приоритет: Высокий  
Источники: [UC-C2](../../use-cases/UC-C2.%20Получить%20доступ%20к%20мероприятию%20по%20ссылке.md)


### FR-C4. Поведение при потере связи и восстановлении

#### FR-C4.1.
Если у пользователя отсутствует сетевое соединение, система должна отображать сообщение о невозможности синхронизации изменений.  
Приоритет: Средний  
Источники: -

#### FR-C4.2.
После восстановления сетевого соединения система должна обновлять отображаемые данные **_Списка покупок_** до актуального состояния.  
Приоритет: Средний  
Источники: -


### FR-C5. Доступ к рецептам и обработка удаления рецепта

#### FR-C5.1.
Система должна предоставлять **_Участнику по ссылке_** возможность открыть **_Рецепт_** из **_Мероприятия_** для просмотра.  
Приоритет: Высокий  
Источники: [BR-C3](../../business-rules.md#br-c3-права-участника-по-ссылке), [UC-C2](../../use-cases/UC-C2.%20Получить%20доступ%20к%20мероприятию%20по%20ссылке.md) 

#### FR-C5.2.
Если **_Рецепт_**, добавленный в **_Мероприятие_**, был удалён, система должна отображать пользователю сообщение о том, что **_Рецепт_** удалён, при попытке открыть этот **_Рецепт_** из **_Мероприятия_**.  
Приоритет: Высокий  
Источники: [BR-C3](../../business-rules.md#br-c3-права-участника-по-ссылке), [UC-C2](../../use-cases/UC-C2.%20Получить%20доступ%20к%20мероприятию%20по%20ссылке.md)
