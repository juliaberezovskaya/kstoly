## 3.4 Совместная работа

### 3.4.1 Описание

Функция **_Совместная работа_** обеспечивает участие нескольких пользователей в подготовке к одному **_Мероприятию_** на основании **_Ссылки-приглашения_**, созданной для **_Мероприятия_**. **_Организатор_** предоставляет доступ к **_Мероприятию_** внешним участникам без полноценной авторизации, передавая **_Ссылку-приглашение_** вне приложения.

**_Участник по ссылке_** получает доступ к просмотру **_Мероприятия_**, **_Рецептов_** мероприятия и **_Списка покупок_**, а также может отмечать **_Пункты списка покупок_** как купленные. Система должна обеспечивать согласованность отметок «куплено/не куплено» для всех пользователей, работающих с одним **_Мероприятием_**.

**Связанные артефакты:**  
Use Cases: `UC-E4`, `UC-L1`, `UC-L3`  
User Stories: `US-E8`, `US-S1`, `US-S2`


### 3.4.2 Функциональные требования


### FR-C1. Доступ по ссылке и сессия участника

#### FR-C1.1. Система должна предоставлять **_Участнику по ссылке_** доступ к **_Мероприятию_** по **_Ссылке-приглашению_**.
Приоритет: Высокий  
Источники: [UC-E4](), [US-E8]()

#### FR-C1.2. Система должна предоставлять **_Участнику по ссылке_** доступ к просмотру метаданных **_Мероприятия_** и списка **_Рецептов_** **_Мероприятия_**.
Приоритет: Высокий  
Источники: [FR-E2.2](), [FR-E2.3](), [FR-E2.4]()

#### FR-C1.3. Система должна предоставлять **_Участнику по ссылке_** доступ к просмотру связанного **_Списка покупок_** **_Мероприятия_**.
Приоритет: Высокий  
Источники: [FR-L1.2](), [FR-L1.3]()

#### FR-C1.4. Система должна обеспечивать возможность одновременного доступа к одному **_Мероприятию_** по одной **_Ссылке-приглашению_** для нескольких **_Участников по ссылке_**.
Приоритет: Средний  
Источники: [UC-E4]()

#### FR-C1.5. Система должна отображать сообщение об ошибке, если доступ к **_Мероприятию_** по **_Ссылке-приглашению_** невозможен (например, ссылка некорректна или **_Мероприятие_** удалено).
Приоритет: Высокий  
Источники: [FR-E2.10](), [UC-E4](), [BR-S2]()


### FR-C2. Ограничения прав участника по ссылке

#### FR-C2.1. Система не должна предоставлять **_Участнику по ссылке_** возможность редактировать метаданные **_Мероприятия_**.
Приоритет: Высокий  
Источники: [FR-E2.8](), [UC-E4]()

#### FR-C2.2. Система не должна предоставлять **_Участнику по ссылке_** возможность изменять состав **_Мероприятия_** (добавлять/удалять **_Рецепты_**, изменять количество порций).
Приоритет: Высокий  
Источники: [FR-E2.8](), [UC-E4]()

#### FR-C2.3. Система не должна предоставлять **_Участнику по ссылке_** возможность вручную изменять **_Список покупок_** (добавлять/редактировать/удалять **_Пункты списка покупок_**, пересоздавать список).
Приоритет: Высокий  
Источники: [FR-L5](), [UC-L4](), [UC-L5]()

> Примечание: **_Участник по ссылке_** может изменять только признак «куплено/не куплено» (см. FR-C3).


### FR-C3. Синхронизация отметок «куплено/не куплено»

#### FR-C3.1. Система должна предоставлять **_Организатору_** и **_Участнику по ссылке_** возможность отмечать **_Пункты списка покупок_** как «куплено/не куплено».
Приоритет: Высокий  
Источники: [FR-L4.1](), [FR-L4.2](), [US-S2]()

#### FR-C3.2. Система должна сохранять изменения признака «куплено/не куплено» для **_Пунктов списка покупок_** и применять их для всех пользователей, имеющих доступ к тому же **_Мероприятию_**.
Приоритет: Высокий  
Источники: [FR-L4.3](), [UC-L3]()

#### FR-C3.3. Система должна обеспечивать отображение актуального состояния признака «куплено/не куплено» для **_Пунктов списка покупок_** всем пользователям, работающим с одним **_Мероприятием_**.
Приоритет: Высокий  
Источники: [UC-L3]()

#### FR-C3.4. В случае одновременного изменения одного и того же **_Пункта списка покупок_** несколькими пользователями система должна применять последнее сохранённое изменение как актуальное значение признака «куплено/не куплено».
Приоритет: Средний  
Источники: [UC-L3]()

#### FR-C3.5. Если изменение признака «куплено/не куплено» не может быть сохранено, система должна отображать пользователю сообщение об ошибке.
Приоритет: Высокий  
Источники: [FR-L4.4](), [BR-S2]()


### FR-C4. Поведение при потере связи и восстановлении

#### FR-C4.1. Если у пользователя отсутствует сетевое соединение, система должна отображать сообщение о невозможности синхронизации изменений.
Приоритет: Средний  
Источники: [BR-S2]()

#### FR-C4.2. После восстановления сетевого соединения система должна обновлять отображаемые данные **_Списка покупок_** до актуального состояния.
Приоритет: Средний  
Источники: [UC-L1](), [UC-L3]()


### FR-C5. Доступ к рецептам и обработка удаления рецепта

#### FR-C5.1. Система должна предоставлять **_Участнику по ссылке_** возможность открыть **_Рецепт_** из **_Мероприятия_** для просмотра.
Приоритет: Высокий  
Источники: [FR-E2.5](), [UC-E4]()

#### FR-C5.2. Если **_Рецепт_**, добавленный в **_Мероприятие_**, был удалён, система должна отображать пользователю сообщение о том, что **_Рецепт_** удалён, при попытке открыть этот **_Рецепт_** из **_Мероприятия_**.
Приоритет: Высокий  
Источники: [FR-E5.14](), [UC-E4](), [BR-S2]()
