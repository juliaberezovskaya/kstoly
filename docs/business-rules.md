# В этом документе описываются бизнес-правила (Business Rules) проекта "К столу!"

## BR-R. Рецепты

## BR-R1. Содержание рецепта

- **BR-R1.1.** Рецепт должен содержать название.
- **BR-R1.2.** Рецепт должен содержать хотя бы один ингредиент.
- **BR-R1.3.** Каждый ингредиент содержит: название, количество, единицу измерения и при необходимости уточнение (тип, вид, бренд и т.п.).
- **BR-R1.4.** Рецепт может содержать шаги приготовления.
- **BR-R1.5.** Рецепт может содержать общее и активное время приготовления.
- **BR-R1.6.** Рецепт может содержать обложку.
- **BR-R1.7.** Название рецепта должно быть уникальным в библиотеке Организатора.

## BR-R2. Ограничения на удаление рецепта

- **BR-R2.1.** Рецепт не может быть удалён, если он используется в мероприятиях.
- **BR-R2.2.** В MVP удалённый рецепт не подлежит восстановлению (корзина отсутствует).


## BR-E. Мероприятия

## BR-E1. Содержание мероприятия

- **BR-E1.1.** Мероприятие должно содержать название.
- **BR-E1.2.** Мероприятие должно содержать дату проведения. 
- **BR-E1.3.** Мероприятие может содержать рецепты
- **BR-E1.4.** Мероприятие может содержать список продуктов, который формируется и обновляется автоматически согласно правилам BR-S1.
- **BR-E1.5.** Мероприятие должно иметь уникальное сочетание названия и даты.
- **BR-E1.6.** Дата проведения мероприятия должна быть действительной календарной датой.

## BR-E2. Архивирование мероприятий
- **BR-E2.1.** Архивированное мероприятие не отображается в основном списке мероприятий.
- **BR-E2.2.** Архивированное мероприятие не может быть отредактировано (в MVP).
- **BR-E2.3.** Архивированное мероприятие может быть открыто только для просмотра (см. UC-E6).
- **BR-E2.4.** Архивированное мероприятие может быть использовано для повторения (UC-E7).

## BR-E3. Удаление мероприятия
- **BR-E3.1.** Удалённое мероприятие не подлежит восстановлению (в MVP).
- **BR-E3.2.** Мероприятие может быть удалено как из основного списка, так и из архива.

**BR-E4.** Повторение мероприятия
- **BR-E4.1.** Повтор мероприятия создаёт новую сущность и не изменяет исходную.
- **BR-E4.2.** Все рецепты копируются в неизменном виде.
- **BR-E4.3.** Количество порций каждого рецепта наследуется от оригинала.
- **BR-E4.4.** Новый список покупок формируется заново согласно BR-S1.


# BR-L. Список покупок

## BR-L1. Формирование и обновление списка покупок мероприятия

- **BR-L1.1.** Базовый список покупок мероприятия формируется на основе ингредиентов всех рецептов, добавленных в мероприятие.
- **BR-L1.2.** При добавлении рецепта в мероприятие его ингредиенты добавляются в список покупок (с учётом объединения одинаковых ингредиентов).
- **BR-L1.3.** При удалении рецепта из мероприятия из списка покупок удаляются только продукты, относящиеся к этому рецепту (количество уменьшается на вклад этого рецепта; если ингредиент больше нигде не используется, он удаляется из списка).
- **BR-L1.4.** Ручные изменения Организатора в списке покупок (удаление/добавление позиций, редактирование количества, замена продукта) должны сохраняться и не должны автоматически перезаписываться при последующих изменениях состава рецептов.
- **BR-L1.5.** Список покупок не пересчитывается полностью при каждом изменении состава рецептов; используются только инкрементальные изменения согласно BR-L1.2 и BR-L1.3.
- **BR-L1.6.** Организатор может вручную инициировать полное пересоздание списка покупок.  При полном пересоздании система удаляет все текущие позиции списка покупок и формирует его заново на основе актуального набора рецептов и их порций.
- **BR-L1.7.** Для каждой позиции в списке покупок должна сохраняться информация о её происхождении: из каких рецептов и ингредиентов она сформирована. Эта информация должна быть доступна пользователю по запросу.
- **BR-L1.8.** Организатор и Участники могут отмечать товары в списке покупок как купленные или не купленные.
- **BR-L1.9.** В MVP добавлять и удалять позиции списка покупок, а также пересоздавать список целиком может только Организатор.
- **BR-L1.10.** У пункта списка продуктов может быть два статуса: "куплен" и "некуплен". Они должны явно показывать пользователю своё значение.

## BR-L2. Масштабирование порций рецептов в мероприятии

- **BR-L2.1.** Каждый рецепт в составе мероприятия может иметь индивидуальный коэффициент порций.
- **BR-L2.2.** Количество каждого ингредиента в списке покупок рассчитывается как:
      ingredient_amount * portion_multiplier.
- **BR-L2.3.** Изменение количества порций рецепта должно корректировать список покупок согласно BR-L1 (инкрементально).

## BR-L3. Содержание ингредиента

- **BR-L3.1** Ингредиент должен содержать название.
- **BR-L3.2** Ингредиент должен содержать количество.
- **BR-L3.3** Ингредиент должен содержать единицы измерения.
- **BR-L3.4** Ингредиент может содержать заметку.


# BR-C. Коллаборация

- **BR-C1** В MVP доступ к мероприятию происходит по ссылке.
- **BR-C2** Все перешедшие по ссылке имеют право просматривать содержание мероприятияю
- **BR-C3** Все перешедшие по ссылке имеют право менять статусы пунктов списка продукта (BR-L1.10).






